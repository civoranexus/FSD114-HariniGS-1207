{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>{{ lesson.title }}</title>
    <link rel="stylesheet" href="{% static 'courses/lessons.css' %}">
</head>

<body>
<div class="lesson-layout">

    <!-- ðŸ“š SIDEBAR -->
    <aside class="lesson-sidebar">
        <h3>{{ course.title }}</h3>

        <ul>
            {% for l in lessons %}
                <li class="
                    {% if l.id == lesson.id %}active{% endif %}
                    {% if l.id in completed_lessons %}completed{% endif %}
                    {% if l.id not in unlocked_lessons %}locked{% endif %}
                ">
                    {% if l.id in unlocked_lessons %}
                        <a href="{% url 'courses:lesson_detail' course.id l.id %}">
                            {{ l.title }}
                        </a>
                    {% else %}
                        ðŸ”’ {{ l.title }}
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    </aside>

    <!-- ðŸ“– MAIN CONTENT -->
    <!-- ðŸ“– MAIN CONTENT -->
<main class="lesson-content">

    <h2>{{ lesson.title }}</h2>

    <!-- ðŸŽ¥ VIDEO -->
    {% if lesson.video %}
    <div class="lesson-video">
        <video width="100%" height="420" controls>
            <source src="{{ lesson.video.url }}" type="video/mp4">
            Your browser does not support the video tag.
        </video>
    </div>
{% endif %}


    <!-- ðŸ“„ SCROLLABLE CONTENT -->
    <div class="lesson-scroll-area" id="lessonScroll">

        {% if lesson.content %}
            <div class="lesson-text">
                {{ lesson.content|linebreaks }}
            </div>
        {% endif %}

    </div>

    <!-- âœ… COMPLETE BUTTON -->
    {% if not progress.completed %}
        <form method="POST"
              action="{% url 'courses:mark_lesson_completed' lesson.id %}">
            {% csrf_token %}
            <button class="complete-btn" id="completeBtn" disabled>
                Mark as Complete
            </button>
        </form>
    {% else %}
        <p class="completed-text">âœ… Lesson Completed</p>
    {% endif %}

    <!-- â¬…âž¡ NAVIGATION -->
    <div class="lesson-nav">
        {% if prev_lesson %}
            <a href="{% url 'courses:lesson_detail' course.id prev_lesson.id %}">
                â¬… Previous
            </a>
        {% endif %}

        {% if next_lesson %}
            <a href="{% url 'courses:lesson_detail' course.id next_lesson.id %}">
                Next âž¡
            </a>
        {% else %}
            <span class="disabled">End of Course</span>
        {% endif %}
    </div>

</main>
</div>
</body>
</html>
